<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="css/style_content.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <div class="top-nav">
    <a href="#">▲</a>
  </div>

  <div id="content">
    <h1>Средства резервного копирования и востановлениие данных</h1>

    <h2>Содержание</h2>
    <p><a href="#begin">Введение</a></p>
    <p><a href="#rs">1 Rsync</a></p>
    <p><a href="#fb">2 Fwbackups</a></p>
    <p><a href="#linux">3 Средство командной строки ОС Linux</a></p>
    <p><a href="#conclusion">Заключение</a></p>

    <h2 id="begin">Введение</h2>
    <p>Данные, программы и информации у всех пользователей есть на ПК. Но что если эти данные были утеряны или пользователь поймал вирус, и он разрушил всю стабильную работу ОС? Для всего этого есть такое понятие, как <b>резервное копирование и средства восстановления</b>.</p>
    <img id="leftimg" src="img/backup.png"><p><b>Резервное копирование</b> — процесс создания копии данных на носителе (жёстком диске, дискете и т. д.), предназначенном для восстановления данных в оригинальном или новом месте их расположения в случае их повреждения или разрушения.</p>
    <p><b>Восстановление данных</b> — процедура извлечения информации с запоминающего устройства в случае, когда она не может быть прочитана обычным способом. Восстановление может осуществляться с любого компьютерного носителя, включая CD, DVD, жёсткие диски, флеш-память и т. д. Как правило, восстановлению подлежат данные, представляющие определённую ценность.</p>
    <p><ul>
      В рамках курсовой работы d среде Linux Ubuntu будут рассмотрены 3 программных средств для этих задач:
      <li>Rsync</li>
      <li>Fwbackups</li>
      <li>Средство командной строки ОС Linux</li>
    </ul>
  </p>
  <div id="prog">
    <img src="img/rsync.png">
    <img src="img/fwbackups.png">
  </div>

    <h2 id="rs">1 Rsync</h2>
    <img id="rightimg"src="img/rsync.png">
    <p>Это очень популярная среди опытных пользователей Linux утилита командной строки для резервного копирования linux. У нее очень много функций, включая инкрементное резервное копирование, обновление дерева каталогов и файловой системы, сохранение прав доступа для файлов, владельца, ссылок, а также работа с резервными копиями как на локальной машине, так и на удаленной.</p>
    <p>В основном в этой утилите работают в командной строке, однако для неё есть и графический интерфейс под названием Grsync. Но главное преимущество в том, что все работы по резервному копированию могут быть автоматизированы с помощью скриптов и cron.</p>
    <figure class="img-left">
      <img id="duo-img" class="my-img" src="img/rsync_01.png">
      <figcaption>Программа в командной строке</figcaption>
    </figure>
    <div id="myModal" class="modal">
      <span class="close" onclick="document.getElementById('myModal').style.display='none'">&times;</span>
      <img class="modal-content" id="img01">
      <div id="caption"></div>
    </div>
    <figure class="img-right">
      <img id="duo-img" class="my-img" src="img/rsync_02.png">
      <figcaption>Программа в графическом интерфейсе</figcaption>
    </figure>
    <div id="myModal" class="modal">
      <span class="close" onclick="document.getElementById('myModal').style.display='none'">&times;</span>
      <img class="modal-content" id="img01">
      <div id="caption"></div>
    </div>

    <br>
    <p>Вот так выглядит эта утилита в командной строке и в графическом интерфейсе Grsync (её надо устанавливать отдельно). У утилиты есть свой синтаксис команд:
      <div id="code">
          rsync [опции] источник [приемник]
      </div>
    <p><b>Опции для локальной работы</b></p>
    <p>Быстрый способ синхронизировать два каталога, это использовать опцию -a:</p>
    <div id="code">
        rsync -a foobar_src/ foobar_dst/
    </div>
    <p>В данном случае файлы и директории из источника скопируются в приемник, при этом, если там были файлы, то совпавшие по имени будут перезаписаны, а остальные не тронуты.</p>
    <p><ul>
      Опция -a задает архивный режим работы утилиты, и является эквивалентом набора опций:
      <li>-r, --recursive — рекурсивный режим;</li>
      <li>-l, --links — пересоздание symlinks, это значит, что символические ссылки будут так же переноситься;</li>
      <li>-p, --perms — перенос прав;</li>
      <li>-t, --times — передача времени модификации и его обновление на удаленной системе. Этот ключ должен быть установлен для точной синхронизации;</li>
      <li>-g, --group — установить группу конечного файла таким же, как и у исходного;</li>
      <li>-o, --owner — установить владельца конечного файла таким же, как и у исходного;</li>
      <li>-D, - same as --devices --specials — установить тип файла устройства и файла специального типа таким же, как у исходного.</li>
    </ul>
  </p>
  <p>Для вывода информации о работе утилиты, существует опция -v, --verbose. Чем больше опций -v, тем боле информативным будет вывод утилиты. Максимальная информативность достигается при четырех опциях -v, --verbose.</p>
</p>
<p><b>Опции для удаленной работы</b></p>
<p>Кроме того, очень полезным будет его способность работать через ssh. Что обеспечивает шифрование канала, что очень важно, если вы синхронизируете два сервера в сети интернет. Для уменьшение трафика, rsync так-же умеет сжимать данные, при передаче по сети.</p>
<p>
  <ul>
    Необходимы следующие опции:
    <li>-e — задать удаленный шелл для использования;</li>
    <li>-z — сжимать передаваемые данные, либо задать;</li>
    <li>-compress-level=9 — сжатие с установкой уровня компрессии.</li>
  </ul>
</p>
<p>Пример копирования с удаленного хоста по протоколу ssh:</p>
<div id="code">
rsync -avv --delete-during -compress-level=9 -e "ssh -p remote_ssh_port" user@host:/dir/to/foobar_src foobar_dst/
</div>
<p>Однако в этом есть недостаток: на стороне источника нужно иметь установленную утилиту rsync.</p>
<p>Далее будет продемонстрирована работа в Grsync</p>
<figure class="img-center">
  <video width="750px" controls="controls">
    <source src="video/Rsync_01.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' />
  </video>
  <figcaption>Работа в программе</figcaption>
</figure>
<p>В программе можно ставить скрипты, например, для ежедневного создания резервной копии. Об этом подробнее можно почитать <a href="https://habr.com/ru/post/128617/"><b>тут</b></a>.</p>
    <h2 id="fb">2 Fwbackups</h2>
    <img id="leftimg" src="img/fwbackups.png" height="125px" width="auto">
    <p>Это бесплатный инструмент с открытым исходным кодом, который можно запускать как в Windows, так и в Linux. У программы простой и интуитивно понятный интерфейс, поэтому пользователи могут очень просто настроить и делать резервные копии.</p>
    <p>Fwbackups поддерживает два основных типа резервных копий: повторяющиеся резервные копии, которые автоматически резервируют ваши файлы по расписанию, и резервные копии, которые запускаются один раз и не запланированы снова. Они называются резервными наборами и одноразовыми резервными копиями соответственно.</p>
    <p>
      <ul>
        Основные преимущества
        <li>Простой в использовании интерфейс</li>
        <li>Гибкость в настройке резервного копирования</li>
        <li>Удаленное резервное копирование</li>
        <li>Резервное копирование всей файловой системы</li>
        <li>Исключение файлов и каталогов из копирования и многое другое</li>
      </ul>
    </p>

    <figure class="img-right">
      <img class="my-img" src="img/fwbackups_01.png"/>
      <figcaption>Представление программы в графическом виде</figcaption>
    </figure>
    <div id="myModal" class="modal">
      <span class="close" onclick="document.getElementById('myModal').style.display='none'">&times;</span>
      <img class="modal-content" id="img01">
      <div id="caption"></div>
    </div>
    <p>Вот так выглядит программа. В ней можно создавать одноразовую копию и набор копий, установив частоту копирования. Так же как и в Rsync, можно делать копии на локальном пути(в файловой системе текущей ОС) и на глобальном пути(на какой-нибудь сервер или облаке) с помощью ssh.</p>
    <br>

    <p>Далее будет представлена демонстрация работы копирования по локальному пути.</p>
    <figure class="img-center">
      <video width="750px" controls="controls">
        <source src="video/fwbackups_01.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' />
      </video>
      <figcaption>Работа в программе</figcaption>
    </figure>

  <p>Всю документацию о программе можно найти на <a href="http://www.diffingo.com/oss/" target="_blank"><b>официальном сайте</b></a> программы.</p>

    <h2 id="linux">3 Средство командной строки ОС Linux</h2>

  <p>
    Довольно часто системным администраторам приходится копировать различные двоичные данные. Например, иногда может понадобиться сделать резервную копию жесткого диска, создать пустой файл, заполненный нулями для организации пространства подкачки или другой виртуальной файловой системы.
  </p>
  <p>
    Для решения всех этих задач используется утилита dd linux, которая просто выполняет копирование данных из одного места в другое на двоичном уровне. Она может скопировать CD/DVD диск, раздел на диске или даже целый жесткий диск. В этой статье мы рассмотрим что из себя представляет команда dd linux, основные ее опции и параметры, а также как ею пользоваться.
  </p>

  <p><b>Как работает команда DD</b></p>
  <p>Сначала нужно понять как работает команда dd и что она делает. Фактически, это аналог утилиты копирования файлов cp только для блочных данных. Утилита просто переносит по одному блоку данных указанного размера с одного места в другое. Поскольку в Linux все, в том числе, устройства, считается файлами, вы можете переносить устройства в файлы и наоборот.
С помощью различных опций утилиты можно повлиять на размер блока, а это, в свою очередь, уже влияет на скорость работы программы. Дальше мы рассмотрим основные опции утилиты и ее возможности.</p>
<p>Команда DD</p>
<p>Синтаксис утилиты достаточно необычен, но в то же время очень прост:</p>
<div id="code">
    dd if=источник_копирования of=место_назначения параметры
</div>

<p>С помощью параметра if вам нужно указать источник, откуда будут копироваться блоки, это может быть устройство, например, /dev/sda или файл - disk.img. Дальше, с помощью параметра of необходимо задать устройство или файл назначения. Другие параметры имеют такой же синтаксис, как if и of.</p>

<p>
  <ul>
    Дополнительные параметры:
    <li><b>bs</b> - указывает сколько байт читать и записывать за один раз;</li>
    <li><b>cbs</b> - сколько байт нужно записывать за один раз;</li>
    <li><b>count</b> - скопировать указанное количество блоков, размер одного блока указывается в параметре bs;</li>
    <li><b>conv</b> - применить фильтры к потоку данных;</li>
    <li><b>ibs</b> - читать указанное количество байт за раз;</li>
    <li><b>obs</b> - записывать указанное количество байт за раз;</li>
    <li><b>seek</b> - пропустить указанное количество байт в начале устройства для чтения;</li>
    <li><b>skip</b> - пропустить указанное количество байт в начале устройства вывода;</li>
    <li><b>status</b> - указывает насколько подробным нужно сделать вывод;</li>
    <li><b>iflag, oflag</b>iflag, oflag - позволяет задать дополнительные флаги работы для устройства ввода и вывода, основные из них: nocache, nofollow.</li>
  </ul>
</p>

<p><b>Как пользоваться DD</b></p>
<p>Обычные пользователи используют команду dd чаще всего для создания образов дисков DVD или CD. Например, чтобы сохранить образ диска в файл можно использовать такую команду:</p>
<div id="code">
sudo dd if=/dev/sr0 of=~/CD.iso bs=2048 conv=noerror
</div>
<p>Фильтр noerror позволяет отключить реагирование на ошибки. Дальше, вы можете создать образ жесткого диска или раздела на нем и сохранить этот образ на диск. Только смотрите не сохраните на тот же жесткий диск или раздел, чтобы не вызвать рекурсию:</p>
<div id="code">
dd if=/dev/sda of=~/disk.img
</div>
<p>В домашней папке будет создан файл с именем disk1.img, который в будущем можно будет развернуть и восстановить испорченную систему. Чтобы записать образ на жесткий диск или раздел достаточно поменять местами адреса устройств:</p>
<div id="code">
dd if=~/disk.img of=/dev/sda
</div>

<p>
  <ul>
    Очень важная и полезная опция - это bs. Она позволяет очень сильно влиять на скорость работы утилиты. Этот параметр позволяет установить размер одного блока при передаче данных. Здесь нужно задать цифровое значение с одним из таких модификаторов формата:
    <li><b>с</b> - один символ;</li>
    <li><b>b</b> - 512 байт;</li>
    <li><b>kB</b> - 1000 байт;</li>
    <li><b>K</b> - 1024 байт;</li>
    <li><b>MB</b> - 1000 килобайт;</li>
    <li><b>M</b> - 1024 килобайт;</li>
    <li><b>GB</b> - 1000 мегабайт;</li>
    <li><b>G</b> - 1024 мегабайт.</li>
  </ul>
</p>
<p><b>Восстановление</b></p>
<p>Для восстановления используется обычная команда развертывания образа на диск.</p>
<p>Если образ диска слишком большой, можно перенаправить весь вывод нестандартный поток вывода утилиты gzip:</p>
<div id="code">
  dd if =/dev/sda2 | bzip2 disk.img.bz2
</div>
<p>Также можно использовать утилиту dd linux для копирования файлов, хотя это и не является ее прямым предназначением:</p>
<div id="code">
dd if=/home/%user%/test.txt of=/home/%user%/test1.txt</div>

<p>Полнкю информцию об утитлите можно узнать <a href="https://losst.ru/komanda-dd-linux"><b>тут</b></a></p>
    <h2 id="conclusion">Заключение</h2>
    <p>В этом разделе были рассмотрены 3 программных средств для резервного копирования и восстановления данных.</p>
    <p>Данная тема является одной из важной часи системы, т.к. копии могут восстановить всю систему и не придется установливать и делать заново. Копии можно хранить в файловой системе, на сервере, в облаке.</p>
    <div id="logo">
      <img src="img/backups_01.png">
    </div>

  </div>

  <script src="js/scripts.js"></script>

</body>
</html>
